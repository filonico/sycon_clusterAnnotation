SeuratExtend::DimPlot2(slac_original, group.by = "clusterID", repel = TRUE,
label = TRUE, label.color = "black", box = TRUE, label.size = 2)
SeuratExtend::DimPlot2(slac_original, group.by = "clusterID", repel = TRUE,
label = TRUE, box = TRUE)
slac_original[[]]
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE)
markers_remapped <- FindAllMarkers(slac_remapped, group.by = "seurat_clusters", only.pos = TRUE)
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE) + NoLegend() + theme_umap_arrows()
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE) + theme_umap_arrows() + NoLegend()
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE) + theme_umap_arrows()
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE, theme = theme_umap_arrows())
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE, theme = c(theme_umap_arrows(), NoLegend()))
SeuratExtend::DimPlot2(slac_original, group.by = "cell_type_abbreviation", repel = TRUE,
label = TRUE, box = TRUE, theme = theme_umap_arrows())
markers_original <- FindAllMarkers(slac_original, group.by = "seurat_clusters", only.pos = TRUE)
rm(markers)
markers_original
markers_original <- FindAllMarkers(slac_original, group.by = "seurat_clusters", only.pos = TRUE)
markers_original <- FindAllMarkers(slac_original, group.by = "clusterID", only.pos = TRUE)
markers_original <- FindAllMarkers(slac_original, group.by = "cell_type_abbreviation", only.pos = TRUE)
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 10) %>%
ungroup() %>%
View()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 10) %>%
ungroup() %>%
filter(cluster == "0")
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 10) %>%
ungroup() %>%
filter(cluster == "0") %>%
pull(gene)
markers_original
markers_original %>%
filter(gene %in% c("c95872-g2", "c39492-g1"))
markers_original %>%
filter(gene %in% c("c95872-g2","c39492-g1","c104944-g2","c104138-g2","c95050-g1","c103117-g1","c104445-g4"))
markers_original %>%
filter(p_val_adj < .05) %>%
filter(gene %in% c("c95872-g2","c39492-g1","c104944-g2","c104138-g2","c95050-g1","c103117-g1","c104445-g4"))
# load diamond best hits between genome and transcriptome proteins
diamond_best_hits_tVSg <- read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_transcriptomeVSgenome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
slice_min(V11) %>%
slice_max(V4) %>%
ungroup() %>%
filter(V3 >= 85)
diamond_best_hits_gVSt <- read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
slice_min(V11) %>%
slice_max(V4) %>%
ungroup() %>%
filter(V3 >= 85)
diamond_reciprocal_bestHits <- diamond_best_hits_tVSg %>%
left_join(diamond_best_hits_gVSt, by = c("V2" = "V1"), suffix = c("tVSg", "gVSt"),
relationship = "many-to-many") %>%
filter(V1 == V2gVSt) %>%
# filter(V2 == "ENSLPGP00000022701.1") %>%
# View()
# select(V2) %>%
group_by(V2) %>%
filter(n()==1) %>%
select(V1, V2) %>%
ungroup()
diamond_reciprocal_bestHits
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(diamond_reciprocal_bestHits %>%
mutate(V2 = str_replace_all(V2, "ENSLPGP", "ENSLPGG"),
V2 = str_replace_all(V2, ".1", "")),
by = join_by("gene" == "V2"))
diamond_best_hits_gVSt
diamond_best_hits_gVSt %>%
select(V1, V2)
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(diamond_best_hits_gVSt %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")),
by = join_by("gene" == "V2"))
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(diamond_best_hits_gVSt %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")),
by = join_by("gene" == "V1"))
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup()
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2)
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")),
by = join_by("gene" == "V1"))
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many")
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
filter(V1 == "ENSLPGP00000001505.1")
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
filter(V1 == "ENSLPGP00000001505.1")
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")) %>%
filter(V1 == "ENSLPGG00000001505")
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")) %>%
View()
filter(V1 == "ENSLPGG00000001505")
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, ".1", "")) %>%
View()
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")) %>%
View()
read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")) %>%
# View()
filter(V1 == "ENSLPGG00000001505")
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many")
by = join_by("gene" == "V1")
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"))
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"))
markers_original[[]]
markers_original
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by(c("V2" == "gene")))
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"))
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many"))
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many")
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
filter(cluster.x == "0")
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
filter(cluster.x == "0") %>%
View()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
filter(cluster.x == "1") %>%
View()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
group_by(cluster.x, cluster.y) %>%
count()
ggplot(aes(x = cluster.x, y = n)) +
geom_col()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
group_by(cluster.x, cluster.y) %>%
count() %>%
ggplot(aes(x = cluster.x, y = n)) +
geom_col()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
group_by(cluster.x, cluster.y) %>%
count() %>%
ggplot(aes(x = cluster.x, y = n, fill = clsuer.y)) +
geom_col()
markers_remapped %>%
group_by(cluster) %>%
arrange(-avg_log2FC) %>%
slice_head(n = 50) %>%
ungroup() %>%
left_join(read.table("03_slac_remapped_clustering/01_diamond_transcriptome_genome/slac_genomeVStranscriptome.tsv",
header = FALSE, sep = "\t", quote = "", na.strings = "") %>%
group_by(V1) %>%
slice_max(V3) %>%
ungroup() %>%
select(V1, V2) %>%
mutate(V1 = str_replace_all(V1, "ENSLPGP", "ENSLPGG"),
V1 = str_replace_all(V1, "\\.1$", "")),
by = join_by("gene" == "V1"),
relationship = "many-to-many") %>%
left_join(markers_original %>%
select(gene, cluster, p_val_adj, avg_log2FC) %>%
filter(p_val_adj <= .05),
by = join_by("V2" == "gene"),
relationship = "many-to-many") %>%
drop_na() %>%
group_by(cluster.x, cluster.y) %>%
count() %>%
ggplot(aes(x = cluster.x, y = n, fill = cluster.y)) +
geom_col()
