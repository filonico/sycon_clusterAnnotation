panel.grid = element_blank(),
legend.title = element_text(hjust = 0.5, face = "bold"))
return(plot)
}
fromTable_toSankey <- function(file_path, prefix_sp1, prefix_sp2, name_sp1, name_sp2, threshold = 0.2) {
df <- tidyup_dataframe(file_path, threshold) %>%
mutate(
x = str_replace_all(x, prefix_sp1, name_sp1),
x = str_replace_all(x, prefix_sp2, name_sp2),
next_x = str_replace_all(next_x, prefix_sp1, name_sp1),
next_x = str_replace_all(next_x, prefix_sp2, name_sp2)
)
plot_sankey(df, c(name_sp1, name_sp2), rep("grey15", 2))
}
# function to plot the network with metacells
get_graph_mtx_metacell <- function(file, threshold) {
adj_mtx <- read.table(file, header = TRUE, sep = "\t") %>%
column_to_rownames(var = "X") %>%
as.matrix()
# set to 0 all the values below a threshold
adj_mtx[adj_mtx < threshold] <- 0
# define all-0 rows and columns (i.e., non-mapping metacells)
zero_rows <- rowSums(adj_mtx) == 0
zero_cols <- colSums(adj_mtx) == 0
# define rows/columns to remove, i.e., only those having all 0s and not photo_metacells
# remove_rows <- zero_rows & !(rownames(adj_mtx) %in% photo_metacells)
# remove_cols <- zero_cols & !(colnames(adj_mtx) %in% photo_metacells)
# not_mapping_metacells <- zero_rows & rownames(adj_mtx) %in% photo_metacells
# names(not_mapping_metacells[not_mapping_metacells == TRUE]) %>% sort()
# remove rows/columns
# adj_mtx_reduced <- adj_mtx[!remove_rows, !remove_cols, drop = FALSE] # remove 0-columns/rows, but not those of photo_metacell
adj_mtx_reduced <- adj_mtx[!zero_rows, !zero_cols, drop = FALSE] # remove all 0-columns/rows, regardless
# build a graph from matrix
graph_mtx <- adj_mtx_reduced %>%
igraph::graph_from_adjacency_matrix(weighted = TRUE, mode = "undirected", diag = FALSE)
return(graph_mtx)
}
plot_heatmap_metacell <- function(graph_mtx) {
adj_mtx <- get.adjacency(graph_mtx, attr = "weight", sparse = FALSE)
heatmap <- adj_mtx %>%
as_tibble(what = "edges", rownames = NA) %>%
rownames_to_column(var = "from") %>%
pivot_longer(-c(from), names_to = "to", values_to = "weight") %>%
# keep only lower triangle
filter(match(from, rownames(adj_mtx)) > match(to, colnames(adj_mtx))) %>%
ggplot(aes(x = from, y = to, fill = weight)) +
geom_tile() +
scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
return(heatmap)
}
samap <- sceasy::convertFormat("04_SAMap/slac_integrated_originalVSremapped.h5ad",
from = "anndata", to = "seurat")
umap <- DimPlot(samap, group.by = "slacOriginal_cell_type", pt.size = 0.2) +
# scale_color_manual(labels = c("mapped to\ntranscriptome", "mapped to\ngenome"),
#                    values = c("#ff0f7b", "#f89b29")) +
ggtitle("Integrated\nSpongilla datasets") +
theme_umap_arrows()
umap
umap <- umap@data %>%
ggplot(aes(UMAP_1, UMAP_2)) +
geom_point(data = subset(umap@data, grepl("unassigned", slacOriginal_cell_type)),
colour = "grey80",
size = 1, alpha = 0.6) +
geom_point(data = subset(umap@data, !grepl("unassigned", slacOriginal_cell_type)),
aes(colour = as.factor(slacOriginal_cell_type)),
size = 1, alpha = 0.6) +
# scale_colour_discrete(name = "",
# labels = c("Mapped to genome", "Mapped to transcriptome")) +
ggtitle("Integrated Spongilla datasets") +
theme_bw()
umap
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(label = weight) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(label = "weight") +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(label = "weight", size = 0.1) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(label = "weight", size = 0.5) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(label = if_else("weight" == 0, "", "weight"), size = 0.5) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(label = if_else("weight" == 0, "", "weight"), size = 0.8) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", weight)), size = 0.8) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", as.character(weight))), size = 0.8) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
round(0.222323)
round(0.222323,digits = 1)
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1)))), size = 0.8) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1))))) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1)))),
size = 1) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1)))),
size = 1.5) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile() +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1)))),
size = 2) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile(col = "white") +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1)))),
size = 2) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
heatmap_mappingScores <- read.table("04_SAMap/03_SAMap_statistics/originalVSremapped_100topCells_samapMappingTable.tsv", sep = "\t",
header = TRUE) %>%
pivot_longer(-X, names_to = "to", values_to = "weight") %>%
filter(grepl("slacOriginal", X) &
grepl("slacRemapped", to)) %>%
mutate(weight = if_else(weight < 0.2, 0, weight)) %>%
ggplot(aes(x = X, y = to, fill = weight)) +
geom_tile(col = "white") +
geom_text(aes(label = if_else(weight == 0, "", as.character(round(weight, 1)))),
size = 2) +
viridis::scale_fill_viridis() +
scale_x_discrete(limits = rev) +
# scale_x_discrete(#limits = rownames(adj_mtx),
#                  labels = function(x) ifelse(x %in% photo_metacells, x, "")) +
# scale_y_discrete(#limits = colnames(adj_mtx),
#                  labels = function(y) ifelse(y %in% photo_metacells, y, "")) +
theme(aspect.ratio = 1,
panel.background = element_blank(),
axis.line = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8))
setwd("/data/evassvis/fn76/sycon/sycon_clusterAnnotation/spongilla_remapping")
library(Seurat)
library(SeuratExtend)
library(tidyverse)
slac_3ext_remapped <- readRDS(file = "03_slac_remapped_clustering/slac_remapped_clustered.Rds")
SeuratExtend::DotPlot2(slac_3ext_remapped,
features = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709"))
Idents(object = slac_3ext_remapped) <- "seurat_clusters_2"
SeuratExtend::DotPlot2(slac_3ext_remapped,
features = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709"))
slac_3ext_remapped <- readRDS(file = "03_slac_remapped_clustering/slac_remapped_clustered.Rds")
SeuratExtend::DotPlot2(slac_3ext_remapped, group.by = "seurat_clusters_2",
features = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709"))
SeuratExtend::DotPlot2(slac_3ext_remapped, #group.by = "seurat_clusters_2",
features = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709"))
slac_3ext_remapped[[]]
slac_3ext_remapped <- readRDS(file = "03_slac_remapped_clustering/slac_3ext_remapped_clustered.h5ad")
slac_3ext_remapped <- readRDS(file = "03_slac_remapped_clustering/slac_3ext_remapped_clustered.Rds")
Idents(object = slac_3ext_remapped) <- "seurat_clusters_2"
SeuratExtend::DotPlot2(slac_3ext_remapped, #group.by = "seurat_clusters_2",
features = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709"))
markers <- list("archaeocytes" = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709"))
SeuratExtend::DotPlot2(slac_3ext_remapped, #group.by = "seurat_clusters_2",
features = markers)
heatmap_mappingScores
markers <- list("archaeocytes" = c("ENSLPGG00000008927", "ENSLPGG00000029352", "ENSLPGG00000010709", "ENSLPGG00000010195"),
"choanocytes" = c("ENSLPGG00000014386"),
"choanoblasts" = c("ENSLPGG00000009033"),
"inc_pinacocytes" = c("ENSLPGG00000007262"))
SeuratExtend::DotPlot2(slac_3ext_remapped, #group.by = "seurat_clusters_2",
features = markers)
SeuratExtend::DimPlot2(slac_3ext_remapped, #group.by = "seurat_clusters_2",
features = markers)
values(markers)
markers[[]]
markers
SeuratExtend::DimPlot2(slac_3ext_remapped, #group.by = "seurat_clusters_2",
features = "ENSLPGG00000010195")
umap
SeuratExtend::DimPlot2(samap, fetaures = c("c41805-g1", "ENSLPGG00000010195"))
SeuratExtend::DimPlot2(samap, features = c("c41805-g1", "ENSLPGG00000010195"))
Features(samap)
SeuratExtend::DimPlot2(samap, features = c("slacOriginal-c41805-g1", "slacRemapped-ENSLPGG00000010195"))
SeuratExtend::DimPlot2(samap, features = c("slacOriginal-c92270-g1", "slacRemapped-ENSLPGG00000029352"))
